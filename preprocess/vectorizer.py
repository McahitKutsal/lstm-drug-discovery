import numpy as np

char_to_int = {'n': 0, '[': 1, '\\': 2, 'E': 3, 'H': 4, ')': 5,
               'B': 6, '9': 7, '2': 8, ']': 9, '7': 10, '!': 11,
               't': 12, 's': 13, 'o': 14, 'c': 15, 'K': 16, '-': 17,
               '/': 18, 'l': 19, 'A': 20, 'r': 21, '@': 22, 'C': 23,
               '=': 24, '6': 25, 'N': 26, 'L': 27, 'a': 28, '5': 29,
               'S': 30, 'T': 31, '#': 32, '+': 33, 'P': 34, 'i': 35,
               '(': 36, '8': 37, '1': 38, 'I': 39, 'e': 40, 'O': 41,
               '3': 42, 'F': 43, '4': 44, '.': 45, 'Z': 46, 'b': 47,
               'G': 48, 'd': 49, 'g': 50, 'M': 51, 'U': 52, 'u': 53}

int_to_char = {'0': 'n', '1': '[', '2': '\\', '3': 'E', '4': 'H',
               '5': ')', '6': 'B', '7': '9', '8': '2', '9': ']', 
               '10': '7', '11': '!', '12': 't', '13': 's', '14': 'o',
               '15': 'c', '16': 'K', '17': '-', '18': '/', '19': 'l',
               '20': 'A', '21': 'r', '22': '@', '23': 'C', '24': '=',
               '25': '6', '26': 'N', '27': 'L', '28': 'a', '29': '5',
               '30': 'S', '31': 'T', '32': '#', '33': '+', '34': 'P',
               '35': 'i', '36': '(', '37': '8', '38': '1', '39': 'I',
               '40': 'e', '41': 'O', '42': '3', '43': 'F', '44': '4',
               '45': '.', '46': 'Z', '47': 'b', '48': 'G', '49': 'd',
               '50': 'g', '51': 'M', '52': 'U', '53': 'u'}
               
def vectorize(smiles, embed, n_vocab):
    one_hot = np.zeros((smiles.shape[0], embed, n_vocab), dtype=np.int8)
    for i, smile in enumerate(smiles):
        one_hot[i,0,char_to_int["!"]] = 1
        for j, c in enumerate(smile):
            one_hot[i,j+1,char_to_int[c]] = 1
        one_hot[i,len(smile)+1:,char_to_int["E"]] = 1
    return one_hot[:,0:-1,:], one_hot[:,1:,:]